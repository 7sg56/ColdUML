@import "tailwindcss";

/* Default dark theme - Deep Dark */
:root {
  --bg: #000000;
  --fg: #ffffff;
  --accent: #0070f3;
  --muted: #666666;
  --surface: #0a0a0a;
  --border: #1a1a1a;
  --panel-border: #1a1a1a;
  --header-h: 56px;
}

/* Light theme variables - Vercel Light */
html.light {
  --bg: #ffffff;
  --fg: #000000;
  --accent: #0070f3;
  --muted: #666666;
  --surface: #fafafa;
  --border: #eaeaea;
  --panel-border: #eaeaea;
}

/* Dark theme variables - Deep Dark */
html.dark {
  --bg: #000000;
  --fg: #ffffff;
  --accent: #0070f3;
  --muted: #666666;
  --surface: #0a0a0a;
  --border: #1a1a1a;
  --panel-border: #1a1a1a;
}

* { box-sizing: border-box; }

html {
  /* Smooth transitions for theme variables */
  transition: background-color 0.3s ease, color 0.3s ease;
}

html, body { height: 100%; }

body {
  margin: 0;
  background: var(--bg);
  color: var(--fg);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
  overflow: hidden; /* lock page scroll */
  /* Smooth transitions for background and text */
  transition: background-color 0.3s ease, color 0.3s ease;
}

.app-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 20px;
  border-bottom: 1px solid var(--border);
  min-height: var(--header-h);
  transition: border-color 0.3s ease;
}
.brand { display: inline-flex; align-items: center; }
.brand-text {
  font-family: 'Georgia', 'Times New Roman', serif;
  font-size: 24px;
  font-weight: 700;
  letter-spacing: -0.5px;
  background: linear-gradient(135deg, var(--accent) 0%, #0070f3 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-shadow: 0 0 20px rgba(0, 112, 243, 0.3);
}

.header-actions {
  display: flex;
  align-items: center;
  gap: 12px;
}

.theme-toggle {
  width: 36px;
  height: 36px;
  border: 1px solid var(--panel-border);
  border-radius: 8px;
  background: var(--surface);
  color: var(--muted);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
}

.theme-toggle:hover:not(:disabled) {
  background: var(--bg);
  border-color: var(--accent);
  color: var(--accent);
  transform: translateY(-1px);
}

.theme-toggle:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none;
}

.theme-toggle.loading {
  border-color: var(--accent);
  color: var(--accent);
}

/* Spin animation for loading spinner */
@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

.animate-spin {
  animation: spin 1s linear infinite;
}

.github-btn {
  width: 36px;
  height: 36px;
  border: 1px solid var(--panel-border);
  border-radius: 8px;
  background: var(--surface);
  color: var(--muted);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  text-decoration: none;
}

.github-btn:hover {
  background: var(--bg);
  border-color: var(--accent);
  color: var(--accent);
  transform: translateY(-1px);
  text-decoration: none;
}

.github-btn:focus {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

.left, .right { 
  height: 100%; 
  min-height: 0; 
  overflow: hidden; 
  margin: 0;
}

.left { 
  border-right: 1px solid var(--panel-border); 
  padding: 16px; 
  display: flex; 
  flex-direction: column; 
  gap: 12px; 
}

.left > .panel { 
  flex: 0 0 auto; 
  margin: 0;
}

.left > .panel.grow { 
  flex: 1 1 0; 
  margin: 0;
}

.right { 
  padding: 16px; 
  display: flex; 
  margin: 0;
}

.right > .panel { 
  flex: 1 1 auto; 
  min-height: 0; 
  margin: 0;
}

/* Panel shell with header actions */
.panel { 
  border: 1px solid var(--panel-border); 
  border-radius: 12px; 
  background: var(--surface); 
  display: flex; 
  flex-direction: column; 
  min-height: 0; 
  overflow: hidden;
  transition: border-color 0.3s ease, background-color 0.3s ease;
}
.panel.grow { flex: 1 1 auto; min-height: 0; }
.panel-header { 
  display: flex; 
  align-items: center; 
  justify-content: space-between; 
  padding: 8px 10px; 
  border-bottom: 1px solid var(--panel-border); 
  border-radius: 12px 12px 0 0; 
  background: color-mix(in oklab, var(--bg) 85%, var(--surface)); 
}

/* Consistent colored panel headers */
.panel-header.editor-header,
.panel-header.preview-header,
.panel-header.templates-header {
  background: linear-gradient(135deg, color-mix(in oklab, var(--accent) 15%, var(--surface)) 0%, color-mix(in oklab, var(--accent) 8%, var(--surface)) 100%);
  border-bottom: 1px solid color-mix(in oklab, var(--accent) 25%, var(--panel-border));
}
.panel-title { 
  font-weight: 600; 
  font-size: 13px; 
  letter-spacing: .2px; 
}
.panel-actions { 
  display: inline-flex; 
  gap: 6px; 
  align-items: center;
}
.icon-btn { 
  min-width: 28px; 
  height: 28px; 
  display: flex; 
  align-items: center; 
  justify-content: center;
  padding: 0 8px;
  background: color-mix(in oklab, var(--surface) 60%, transparent); 
  border: 1px solid color-mix(in oklab, var(--panel-border) 80%, transparent); 
  border-radius: 6px; 
  color: var(--muted); 
  cursor: pointer; 
  transition: all .15s ease; 
  font-size: 12px;
  font-weight: 500;
}
.icon-btn svg { 
  width: 14px; 
  height: 14px; 
  flex-shrink: 0;
}
.icon-btn:hover { 
  background: color-mix(in oklab, var(--accent) 20%, var(--surface)); 
  border-color: var(--accent); 
  color: var(--accent);
  transform: translateY(-1px);
}
.icon-btn:focus { 
  outline: 2px solid var(--accent); 
  outline-offset: 2px; 
}
.panel-body { 
  padding: 10px; 
  flex: 1 1 auto; 
  min-height: 0; 
  display: flex; 
  flex-direction: column; 
}

/* Ensure editor internals consume full height */
.editor-body { display: flex; flex: 1 1 auto; min-height: 0; }
.panel-body .editor-wrap { flex: 1 1 auto; min-height: 0; }
.panel-body .preview { flex: 1 1 auto; min-height: 0; }

/* Editor scrolling fix for all screen sizes */
.monaco-editor {
  overflow: auto !important;
  -webkit-overflow-scrolling: touch !important;
  touch-action: pan-y !important;
}

.monaco-editor .view-lines {
  overflow: visible !important;
}

.monaco-editor .view-overlays {
  overflow: visible !important;
}

.monaco-editor .margin {
  overflow: visible !important;
}

/* Ensure editor container allows scrolling */
.monaco-editor-wrapper {
  overflow: auto !important;
  -webkit-overflow-scrolling: touch !important;
  height: 100% !important;
  touch-action: pan-y !important;
}

/* Fix for panel layout on all screen sizes */
.left > .panel.grow {
  overflow: hidden !important;
}

.left > .panel.grow .monaco-editor-wrapper {
  overflow: auto !important;
  -webkit-overflow-scrolling: touch !important;
}

/* Additional fixes for medium and large screens */
@media (min-width: 768px) {
  .monaco-editor {
    overflow: auto !important;
  }
  
  .monaco-editor-wrapper {
    overflow: auto !important;
    height: 100% !important;
  }
  
  .left > .panel.grow {
    overflow: hidden !important;
  }
  
  .left > .panel.grow .monaco-editor-wrapper {
    overflow: auto !important;
  }
}

/* Ensure proper height and scrolling for all screen sizes */
.panel.grow {
  display: flex !important;
  flex-direction: column !important;
  min-height: 0 !important;
}

.panel.grow .monaco-editor-wrapper {
  flex: 1 !important;
  min-height: 0 !important;
  overflow: auto !important;
}

/* Fix for Monaco Editor internal scrolling */
.monaco-editor .overflow-guard {
  overflow: auto !important;
}

.monaco-editor .monaco-scrollable-element {
  overflow: auto !important;
}

/* Mobile viewport fix */
@supports (-webkit-touch-callout: none) {
  /* iOS specific fix for viewport height */
  body {
    min-height: -webkit-fill-available;
  }
  
  .h-screen {
    height: -webkit-fill-available;
  }
}

/* Monaco Editor Styles */
.monaco-editor-container {
  width: 100%;
  height: 100%;
  flex: 1 1 auto;
  min-height: 0;
  border-radius: 0 8px 8px 0;
  overflow: hidden;
}

.monaco-loading {
  display: flex; 
  align-items: center;
  justify-content: center;
  height: 100%;
  background: var(--surface);
  border-radius: 0 8px 8px 0;
}

.loading-text {
  color: var(--muted);
  font-size: 14px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}

.monaco-editor-wrapper {
  width: 100%;
  height: 100%;
  flex: 1 1 auto;
  min-height: 0;
}

/* Monaco Editor theme overrides */
.monaco-editor-container .monaco-editor {
  border-radius: 0 8px 8px 0;
}

.monaco-editor-container .monaco-editor .view-lines {
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace !important;
}

/* Monaco Editor line numbers spacing */
.monaco-editor-container .monaco-editor .margin {
  display: none !important;
  width: 0 !important;
}

.monaco-editor-container .monaco-editor .margin-view-overlays {
  display: none !important;
  width: 0 !important;
}

.monaco-editor-container .monaco-editor .line-numbers {
  color: var(--muted) !important;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace !important;
  font-size: 14px !important;
  line-height: 24px !important;
  padding-right: 16px !important;
  text-align: right !important;
  width: 60px !important;
}

/* Monaco Editor content area spacing */
.monaco-editor-container .monaco-editor .view-lines {
  padding-left: 10px !important;
  padding-right: 16px !important;
  margin-left: 0 !important;
}

.monaco-editor-container .monaco-editor .view-line {
  padding-left: 0 !important;
}

/* Ensure proper spacing between line numbers and content */
.monaco-editor-container .monaco-editor .lines-content {
  margin-left: 0 !important;
}

/* Additional spacing fixes */
.monaco-editor-container .monaco-editor .overflow-guard {
  overflow: hidden !important;
}

.monaco-editor-container .monaco-editor .monaco-editor-background {
  background: var(--surface) !important;
}

/* Force proper line number area width */
.monaco-editor-container .monaco-editor .margin-view-overlays .line-numbers {
  display: none !important;
  width: 0 !important;
  min-width: 0 !important;
  max-width: 0 !important;
}

/* Content area positioning */
.monaco-editor-container .monaco-editor .view-overlays {
  left: 0 !important;
}

/* Custom Monaco theme for dark mode - Lighter Vercel Dark */
.monaco-editor-container .monaco-editor.vs-dark {
  --vscode-editor-background: #1a1a1a;
  --vscode-editor-foreground: #ffffff;
  --vscode-editorLineNumber-foreground: #888888;
  --vscode-editorLineNumber-activeForeground: #ffffff;
  --vscode-editor-selectionBackground: rgba(0, 112, 243, 0.3);
  --vscode-editor-selectionHighlightBackground: rgba(0, 112, 243, 0.1);
  --vscode-editorCursor-foreground: #ffffff;
  --vscode-editorWhitespace-foreground: #888888;
  --vscode-editorIndentGuide-background: #2a2a2a;
  --vscode-editorIndentGuide-activeBackground: #888888;
}

/* Custom Monaco theme for light mode - Vercel Light */
.monaco-editor-container .monaco-editor.vs {
  --vscode-editor-background: #ffffff;
  --vscode-editor-foreground: #000000;
  --vscode-editorLineNumber-foreground: #666666;
  --vscode-editorLineNumber-activeForeground: #000000;
  --vscode-editor-selectionBackground: rgba(0, 112, 243, 0.3);
  --vscode-editor-selectionHighlightBackground: rgba(0, 112, 243, 0.1);
  --vscode-editorCursor-foreground: #000000;
  --vscode-editorWhitespace-foreground: #666666;
  --vscode-editorIndentGuide-background: #eaeaea;
  --vscode-editorIndentGuide-activeBackground: #666666;
}

/* Mermaid diagram styling with reliable fonts */
.mermaid {
  font-family: Arial, sans-serif !important;
  font-size: 10px !important;
}

.mermaid svg {
  font-family: Arial, sans-serif !important;
  max-width: 100% !important;
  height: auto !important;
}

.mermaid text,
.mermaid tspan {
  font-family: Arial, sans-serif !important;
  font-size: 9px !important;
  fill: currentColor !important;
}

/* Ensure proper text rendering in dark mode - Vercel Dark */
html.dark .mermaid text,
html.dark .mermaid tspan {
  fill: #ffffff !important;
}

/* Ensure proper text rendering in light mode - GitHub Light */
html.light .mermaid text,
html.light .mermaid tspan {
  fill: #24292e !important;
}

/* Fix for class diagram boxes - theme aware */
html.dark .mermaid .classBox {
  fill: #1a1a1a !important;
  stroke: #2a2a2a !important;
}

html.light .mermaid .classBox {
  fill: #f6f8fa !important;
  stroke: #d0d7de !important;
}

/* Fix for relationship lines - theme aware */
html.dark .mermaid .relation {
  stroke: #888888 !important;
}

html.light .mermaid .relation {
  stroke: #6a737d !important;
}

/* Fix for all mermaid elements in light mode */
html.light .mermaid .node rect,
html.light .mermaid .node circle,
html.light .mermaid .node ellipse,
html.light .mermaid .node polygon {
  fill: #f6f8fa !important;
  stroke: #d0d7de !important;
}

html.light .mermaid .edgePath .path {
  stroke: #6a737d !important;
}

html.light .mermaid .edgeLabel {
  background-color: #f6f8fa !important;
  color: #24292e !important;
}

/* Fix for class diagram boxes */
.mermaid .classBox {
  fill: var(--surface) !important;
  stroke: var(--border) !important;
}

/* Fix for relationship lines */
.mermaid .relation {
  stroke: var(--muted) !important;
}

/* Ensure diagrams are responsive */
.mermaid svg {
  width: 100% !important;
  max-width: 100% !important;
}

.preview { 
  height: 100%; 
  width: 100%; 
  flex: 1 1 auto; 
  min-width: 0; 
  border: none; 
  border-radius: 8px; 
  padding: 16px; 
  overflow: auto; 
  background: var(--surface);
  position: relative; /* Contain absolute positioned error overlays */
}
.preview img { max-width: 100%; height: auto; }

.toast { 
  position: fixed; 
  left: 50%; 
  bottom: 20px; 
  transform: translateX(-50%); 
  background: var(--fg); 
  color: var(--bg); 
  padding: 8px 12px; 
  border-radius: 999px; 
  font-size: 12px; 
  opacity: 0; 
  pointer-events: none; 
  transition: opacity .2s ease; 
}
.toast.show { opacity: 1; }

/* Completely hide Mermaid error messages */
.mermaid .error-icon,
.mermaid .error-text,
.mermaid .error-message,
.mermaid [class*="error"],
.mermaid [id*="error"],
.mermaid .mermaid-error,
.mermaid .syntax-error,
.mermaid .parse-error {
  display: none !important;
  visibility: hidden !important;
  opacity: 0 !important;
  height: 0 !important;
  width: 0 !important;
  overflow: hidden !important;
}

/* Hide any Mermaid error containers */
.mermaid div[class*="error"],
.mermaid div[id*="error"],
.mermaid .error-container,
.mermaid .mermaid-error-container {
  display: none !important;
  visibility: hidden !important;
  opacity: 0 !important;
  height: 0 !important;
  width: 0 !important;
  overflow: hidden !important;
}

/* Hide Mermaid error SVGs and graphics */
.mermaid svg[class*="error"],
.mermaid svg[id*="error"],
.mermaid .error-svg,
.mermaid .bomb-icon,
.mermaid .error-icon-svg {
  display: none !important;
  visibility: hidden !important;
  opacity: 0 !important;
  height: 0 !important;
  width: 0 !important;
  overflow: hidden !important;
}

/* Global rule to hide any Mermaid error elements */
[data-testid="mermaid-preview-container"] .mermaid [class*="error"],
[data-testid="mermaid-preview-container"] .mermaid [id*="error"],
[data-testid="mermaid-preview-container"] .mermaid .error-icon,
[data-testid="mermaid-preview-container"] .mermaid .error-text,
[data-testid="mermaid-preview-container"] .mermaid .error-message,
[data-testid="mermaid-preview-container"] .mermaid .mermaid-error,
[data-testid="mermaid-preview-container"] .mermaid .syntax-error,
[data-testid="mermaid-preview-container"] .mermaid .parse-error,
[data-testid="mermaid-preview-container"] .mermaid div[class*="error"],
[data-testid="mermaid-preview-container"] .mermaid div[id*="error"],
[data-testid="mermaid-preview-container"] .mermaid .error-container,
[data-testid="mermaid-preview-container"] .mermaid .mermaid-error-container,
[data-testid="mermaid-preview-container"] .mermaid svg[class*="error"],
[data-testid="mermaid-preview-container"] .mermaid svg[id*="error"],
[data-testid="mermaid-preview-container"] .mermaid .error-svg,
[data-testid="mermaid-preview-container"] .mermaid .bomb-icon,
[data-testid="mermaid-preview-container"] .mermaid .error-icon-svg {
  display: none !important;
  visibility: hidden !important;
  opacity: 0 !important;
  height: 0 !important;
  width: 0 !important;
  overflow: hidden !important;
  position: absolute !important;
  left: -9999px !important;
  top: -9999px !important;
}

/* Monaco Editor - Ensure cursor remains visible and editor stays interactive */
.monaco-editor .cursor,
.monaco-editor .cursors-layer {
  display: block !important;
  visibility: visible !important;
  opacity: 1 !important;
}

/* Prevent editor from becoming disabled during error state */
.monaco-editor .view-lines,
.monaco-editor .view-overlays,
.monaco-editor .overlayWidgets,
.monaco-editor .inputarea {
  pointer-events: auto !important;
}

/* Ensure the editor is always interactive and focusable */
.monaco-editor-wrapper {
  cursor: text !important;
}

.monaco-editor {
  pointer-events: auto !important;
}

.monaco-editor .monaco-editor-background,
.monaco-editor .overflow-guard {
  pointer-events: auto !important;
}

/* Ensure cursor blinks even with error styling */
.monaco-editor .cursor {
  animation: monaco-cursor-blink 1s step-end infinite !important;
  display: block !important;
}

.monaco-editor .cursors-layer {
  display: block !important;
}

@keyframes monaco-cursor-blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0; }
}

/* Force cursor to be visible always */
.monaco-editor .cursor-line-style {
  display: block !important;
  visibility: visible !important;
}

/* Ensure text input area is always active */
.monaco-editor textarea.inputarea {
  pointer-events: auto !important;
  opacity: 0 !important;
  position: absolute !important;
}

/* Ensure proper scrolling in panels */
.panel-scroll {
  overflow-y: auto;
  overflow-x: hidden;
}

/* Main app container - full height, no scroll */
#__next {
  height: 100vh;
  overflow: hidden;
}

/* Root container - full height, no scroll */
html, body {
  height: 100%;
  overflow: hidden;
  position: fixed;
  width: 100%;
  top: 0;
  left: 0;
}

/* Main layout - full height, no scroll */
main {
  height: 100vh;
  overflow: hidden;
}

/* Editor and preview panels - internal scroll only */
.monaco-editor-wrapper {
  height: 100%;
  overflow: hidden;
}

.monaco-editor {
  height: 100% !important;
}

/* Preview container - internal scroll only */
[data-testid="mermaid-preview-container"] {
  height: 100%;
  overflow: auto;
  overflow-x: hidden;
}

/* Prevent content from overflowing */
.panel-content {
  min-height: 0;
  flex: 1;
  display: flex;
  flex-direction: column;
}

/* Responsive layout utilities */
@media (max-width: 640px) {
  /* Small mobile: Vertical stack with fixed-height scrollable boxes */
  #main-content {
    flex-direction: column !important;
    padding: 0 !important;
    gap: 0 !important;
  }
  
  /* Templates panel - compact horizontal scrollable bar */
  .left {
    display: flex !important;
    flex-direction: column !important;
    border-right: none !important;
    border-bottom: 1px solid var(--panel-border);
    padding: 8px !important;
    gap: 8px !important;
    height: auto !important;
    flex: 0 0 auto !important;
  }
  
  .left > .panel:first-child {
    height: 60px !important;
    min-height: 60px !important;
    max-height: 60px !important;
    flex: 0 0 60px !important;
    overflow: hidden !important;
  }
  
  .left > .panel:first-child .panel-body {
    padding: 4px 8px !important;
    overflow-x: auto !important;
    overflow-y: hidden !important;
    -webkit-overflow-scrolling: touch !important;
  }
  
  /* Editor panel - fixed height with internal scroll */
  .left > .panel.grow {
    height: 300px !important;
    min-height: 300px !important;
    max-height: 300px !important;
    flex: 0 0 300px !important;
    overflow: hidden !important;
  }
  
  .left > .panel.grow .panel-body {
    overflow: hidden !important;
    height: 100% !important;
  }
  
  .left > .panel.grow .monaco-editor-wrapper {
    overflow: auto !important;
    -webkit-overflow-scrolling: touch !important;
    height: 100% !important;
  }
  
  /* Preview panel - remaining height with internal scroll */
  .right {
    flex: 1 1 auto !important;
    min-height: 0 !important;
    padding: 8px !important;
    border-left: none !important;
  }
  
  .right .panel {
    height: 100% !important;
    overflow: hidden !important;
  }
  
  .right .panel-body {
    overflow: hidden !important;
  }
  
  .right .preview {
    overflow-y: auto !important;
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }
  
  /* Compact panel headers on mobile */
  .panel-header {
    padding: 6px 10px !important;
    min-height: 36px !important;
  }
  
  .panel-title {
    font-size: 12px !important;
  }
  
  .icon-btn {
    min-width: 26px !important;
    height: 26px !important;
    font-size: 11px !important;
  }
  
  .icon-btn svg {
    width: 13px !important;
    height: 13px !important;
  }
}

@media (min-width: 641px) and (max-width: 1023px) {
  /* Tablet: Vertical stack with well-defined scrollable boxes */
  #main-content {
    flex-direction: column !important;
    gap: 0 !important;
  }
  
  /* Templates panel - horizontal scrollable bar at top */
  .left {
    display: flex !important;
    flex-direction: column !important;
    border-right: none !important;
    border-bottom: 1px solid var(--panel-border);
    padding: 12px !important;
    gap: 12px !important;
    height: auto !important;
    flex: 0 0 auto !important;
  }
  
  .left > .panel:first-child {
    height: 80px !important;
    min-height: 80px !important;
    max-height: 80px !important;
    flex: 0 0 80px !important;
    overflow: hidden !important;
  }
  
  .left > .panel:first-child .panel-body {
    padding: 8px !important;
    overflow-x: auto !important;
    overflow-y: hidden !important;
    -webkit-overflow-scrolling: touch !important;
  }
  
  /* Editor panel - fixed height with internal scroll */
  .left > .panel.grow {
    height: 350px !important;
    min-height: 350px !important;
    max-height: 350px !important;
    flex: 0 0 350px !important;
    overflow: hidden !important;
  }
  
  .left > .panel.grow .panel-body {
    overflow: hidden !important;
  }
  
  .left > .panel.grow .monaco-editor-wrapper {
    overflow: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }
  
  /* Preview panel - remaining height with internal scroll */
  .right {
    flex: 1 1 auto !important;
    min-height: 0 !important;
    padding: 12px !important;
    border-left: none !important;
  }
  
  .right .panel {
    height: 100% !important;
    overflow: hidden !important;
  }
  
  .right .panel-body {
    overflow: hidden !important;
  }
  
  .right .preview {
    overflow-y: auto !important;
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }
}

@media (min-width: 1024px) and (max-width: 1279px) {
  /* Large tablet/small desktop: Vertical layout with scrollable boxes */
  #main-content {
    flex-direction: column !important;
    gap: 0 !important;
  }
  
  /* Templates panel - compact horizontal scrollable bar */
  .left {
    display: flex !important;
    flex-direction: column !important;
    border-right: none !important;
    border-bottom: 1px solid var(--panel-border);
    padding: 14px !important;
    gap: 14px !important;
    height: auto !important;
    flex: 0 0 auto !important;
  }
  
  .left > .panel:first-child {
    height: 90px !important;
    min-height: 90px !important;
    max-height: 90px !important;
    flex: 0 0 90px !important;
    overflow: hidden !important;
  }
  
  .left > .panel:first-child .panel-body {
    padding: 10px !important;
    overflow-x: auto !important;
    overflow-y: hidden !important;
    -webkit-overflow-scrolling: touch !important;
  }
  
  /* Editor panel - fixed height with internal scroll */
  .left > .panel.grow {
    height: 400px !important;
    min-height: 400px !important;
    max-height: 400px !important;
    flex: 0 0 400px !important;
    overflow: hidden !important;
  }
  
  .left > .panel.grow .panel-body {
    overflow: hidden !important;
  }
  
  .left > .panel.grow .monaco-editor-wrapper {
    overflow: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }
  
  /* Preview panel - remaining height with internal scroll */
  .right {
    flex: 1 1 auto !important;
    min-height: 0 !important;
    padding: 14px !important;
    border-left: none !important;
  }
  
  .right .panel {
    height: 100% !important;
    overflow: hidden !important;
  }
  
  .right .panel-body {
    overflow: hidden !important;
  }
  
  .right .preview {
    overflow-y: auto !important;
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }
}

@media (min-width: 1280px) {
  /* Desktop: Three-panel layout side by side with normal desktop behavior */
  #main-content {
    flex-direction: row !important;
  }
  
  .left {
    width: auto !important;
    flex: 1 !important;
    border-right: 1px solid var(--panel-border) !important;
    border-bottom: none !important;
    padding: 16px !important;
    gap: 12px !important;
    display: flex !important;
    flex-direction: column !important;
  }
  
  .left > .panel:first-child {
    height: auto !important;
    min-height: auto !important;
    max-height: none !important;
    flex: 0 0 auto !important;
  }
  
  .left > .panel.grow {
    height: auto !important;
    min-height: 0 !important;
    max-height: none !important;
    flex: 1 1 0 !important;
  }
  
  .right {
    flex: 1 !important;
    padding: 16px !important;
    border-left: none !important;
  }
}

/* Mobile-specific improvements for touch interactions */
@media (max-width: 1023px) {
  /* Compact header on mobile/tablet */
  .app-header {
    padding: 12px 16px !important;
    min-height: 50px !important;
  }
  
  .brand-text {
    font-size: 20px !important;
  }
  
  .theme-toggle,
  .github-btn {
    width: 32px !important;
    height: 32px !important;
  }
  
  /* Touch-friendly button sizes */
  .icon-btn {
    min-width: 32px !important;
    height: 32px !important;
    touch-action: manipulation !important;
  }
  
  /* Horizontal scrolling for templates */
  .left > .panel:first-child .panel-body {
    display: flex !important;
    align-items: center !important;
  }
  
  /* Prevent text selection during scrolling */
  .panel-body {
    -webkit-user-select: none !important;
    user-select: none !important;
  }
  
  /* But allow text selection in editor */
  .monaco-editor,
  .monaco-editor * {
    -webkit-user-select: text !important;
    user-select: text !important;
  }
  
  /* Smooth scrolling on mobile */
  .panel,
  .panel-body,
  .preview,
  .monaco-editor-wrapper {
    scroll-behavior: smooth !important;
  }
  
  /* Hide scrollbars but keep functionality */
  .left > .panel:first-child .panel-body::-webkit-scrollbar {
    height: 4px !important;
  }
  
  .left > .panel:first-child .panel-body::-webkit-scrollbar-thumb {
    background: var(--muted) !important;
    border-radius: 2px !important;
  }
  
  .left > .panel:first-child .panel-body::-webkit-scrollbar-track {
    background: transparent !important;
  }
  
  /* Better scrollbars for preview and editor on mobile */
  .preview::-webkit-scrollbar,
  .monaco-editor-wrapper::-webkit-scrollbar {
    width: 6px !important;
    height: 6px !important;
  }
  
  .preview::-webkit-scrollbar-thumb,
  .monaco-editor-wrapper::-webkit-scrollbar-thumb {
    background: var(--muted) !important;
    border-radius: 3px !important;
  }
  
  .preview::-webkit-scrollbar-track,
  .monaco-editor-wrapper::-webkit-scrollbar-track {
    background: var(--surface) !important;
  }
  
  /* Prevent iOS Safari bounce on panels */
  .panel,
  .panel-body {
    overscroll-behavior: contain !important;
  }
  
  /* Optimize touch events */
  button,
  .icon-btn,
  .theme-toggle,
  .github-btn {
    -webkit-tap-highlight-color: transparent !important;
  }
}

/* Smooth theme transitions */
* {
  transition: background-color 0.2s ease-in-out, border-color 0.2s ease-in-out, color 0.2s ease-in-out;
}

/* Responsive spacing utilities */
.responsive-padding {
  padding: 0.5rem;
}

@media (min-width: 640px) {
  .responsive-padding {
    padding: 0.75rem;
  }
}

@media (min-width: 1280px) {
  .responsive-padding {
    padding: 1rem;
  }
}

/* Responsive text utilities */
.responsive-text {
  font-size: 0.75rem;
}

@media (min-width: 640px) {
  .responsive-text {
    font-size: 0.875rem;
  }
}

/* Layout container utilities */
.layout-container {
  display: flex;
  flex-direction: column;
  height: 100%;
  min-height: 0;
}

@media (min-width: 1280px) {
  .layout-container-horizontal {
    flex-direction: row;
  }
}

/* Panel sizing utilities */
.panel-compact {
  min-height: 140px;
  max-height: 140px;
}

@media (min-width: 641px) {
  .panel-compact {
    min-height: 160px;
    max-height: 160px;
  }
}

@media (min-width: 1024px) {
  .panel-compact {
    min-height: 180px;
    max-height: 180px;
  }
}

@media (min-width: 1280px) {
  .panel-compact {
    min-height: auto;
    max-height: none;
  }
}

/* Responsive utilities */
.responsive-grid {
  display: grid;
  gap: 0.5rem;
}

/* Mobile: 2 columns for templates */
@media (max-width: 640px) {
  .responsive-grid {
    grid-template-columns: repeat(2, 1fr);
    gap: 0.375rem;
  }
}

/* Tablet: 3-4 columns when helper panel is on top */
@media (min-width: 641px) and (max-width: 1279px) {
  .responsive-grid {
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 0.5rem;
  }
}

/* Desktop: Single column when helper panel is on side */
@media (min-width: 1280px) {
  .responsive-grid {
    grid-template-columns: 1fr;
    gap: 0.75rem;
  }
}

/* Panel height utilities */
.panel-responsive-height {
  min-height: 200px;
}

@media (min-width: 641px) {
  .panel-responsive-height {
    min-height: 300px;
  }
}

@media (min-width: 1024px) {
  .panel-responsive-height {
    min-height: 400px;
  }
}

@media (min-width: 1280px) {
  .panel-responsive-height {
    min-height: auto;
  }
}

/* Panel styling */
.panel-header {
  background-color: var(--header-background);
  border-bottom: 1px solid var(--header-border);
}

/* Button variants */
.btn-primary {
  background-color: var(--primary);
  color: var(--primary-foreground);
  transition: background-color 0.2s ease-in-out;
}

.btn-primary:hover {
  background-color: color-mix(in srgb, var(--primary) 90%, transparent);
}

.btn-primary:focus {
  outline: none;
  box-shadow: 0 0 0 2px var(--ring);
}

.btn-secondary {
  background-color: var(--button-background);
  color: var(--foreground);
  border: 1px solid var(--border);
  transition: background-color 0.2s ease-in-out;
}

.btn-secondary:hover {
  background-color: var(--button-hover);
}

.btn-secondary:focus {
  outline: none;
  box-shadow: 0 0 0 2px var(--ring);
}

.btn-ghost:hover {
  background-color: var(--accent);
  color: var(--accent-foreground);
}

.btn-ghost:focus {
  outline: none;
  box-shadow: 0 0 0 2px var(--ring);
}

/* Simple animations */
@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* Accessibility and UX improvements */
html {
  scroll-behavior: smooth;
}

::selection {
  background-color: var(--primary);
  color: var(--primary-foreground);
}

/* UML Template Button Animations */
.transform {
  transition: transform 0.2s ease-in-out;
}

.scale-102 {
  transform: scale(1.02);
}

.scale-105 {
  transform: scale(1.05);
}
